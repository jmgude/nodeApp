<%- include('includes/head') %>
<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7/leaflet.css" />
<script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
<script src='https://api.tiles.mapbox.com/mapbox.js/v1.6.4/mapbox.js'></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>
</head>


<body>
  <%- include('includes/nav') %>

  <div id="map"></div>
  <p><a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a></p>

  <script>
    
     var map = L.map('map').setView([0, 0], 1);

     
    L.tileLayer('https://api.maptiler.com/maps/topo/{z}/{x}/{y}.png?key=LL6XXiKxOGOAPCYNO1xW',{
      tileSize: 512,
      zoomOffset: -1,
      minZoom: 1,
      attribution: '<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>',
      crossOrigin: true
    }).addTo(map);
    

getLocation()


function getLocation() {
if (navigator.geolocation) {
  navigator.geolocation.getCurrentPosition(showPosition);
} else { 
 console.log ( "Geolocation is not supported by this browser.");
}

}
    function showPosition(position) {
var lat = position.coords.latitude;
var lon =position.coords.longitude;


   
    console.log(lat)
    console.log(lon)
    
    var marker=L.marker([lat,lon]).addTo(map);
    
    

    var marker = new L.Marker([lat, lon]).on('click', markerOnClick).addTo(map);

function markerOnClick(e)
{

marker.bindPopup("<h1>Example - DaCun</h1><p>Example - Technical info</p><ul><li>Asset Owner: xxxx Rail Authority</li><li>Location: xxxx</li><li>xxxg</li></ul>")
document.getElementById("addressID").src = "http://10.25.32.227:8080";
document.getElementById("siteName").innerHTML="xxx - xxxx";
}


  }
  var marker=L.marker([35.10418, -106.62987]).bindPopup("I am a Marker");
  
var marker2=L.marker([23.9983085, 120.5560793]).bindPopup("I am Marker 2");





var polyline=L.polyline([[35.10418, -106.62987],[35.19738, -106.875],[35.07946, -106.80634]], {color: 'red',weight:8}).bindPopup("I am a Polyline");
var myLayerGroup=L.layerGroup([marker, polyline]).addTo(map); 
myLayerGroup.addLayer(marker2);

marker.bindPopup("<h1>RCSA - DaCun</h1><p>RCSA - LCLX Solutions inc Speed Proving</p><ul><li>Asset Owner: Taiwan Rail Authority</li><li>Location: Dacun</li><li>RCSA Solution:LCLX inc. Speed Proving</li></ul>")



 </script>

 <div>
   <h1 id="Site">Site</h1>
   <h2 id="siteName"></h2>
 </div>
 <iframe id="addressID" src="" width="100%" height="900" style="border:none;">
 </iframe>

 
 <%- include('includes/footer') %>